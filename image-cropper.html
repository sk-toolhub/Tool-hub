<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Free Image Cropper - Crop Photos Online | Crop Images to Custom Size | SK Toolhub</title>
  <meta name="description" content="Crop images online for free. Crop photos to custom size, aspect ratios, remove unwanted parts. Perfect for profile pictures, social media, and web use.">
  <meta name="keywords" content="image cropper, crop photo online, crop image to size, photo cropper tool, crop picture, crop image for social media, crop profile picture, online crop tool, free image cropper, crop jpg png webp, crop image to square, crop image to circle, crop image to custom size, crop image for instagram, crop image for facebook">
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Free Online Image Cropper - Crop Photos to Any Size">
  <meta property="og:description" content="Crop images to custom dimensions or preset ratios. Free online crop tool for profile pictures, social media, and websites.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.sktoolhub.in/image-cropper.html">
  <meta property="og:site_name" content="SK Tool Hub">
  <meta property="og:image" content="https://www.sktoolhub.in/assets/image-cropper-og.jpg">
  <meta property="og:image:type" content="image/jpeg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Free Image Cropper Online - Crop Photos Instantly">
  <meta name="twitter:description" content="Crop images to any size or aspect ratio. Perfect for social media profile pictures.">
  <meta name="twitter:image" content="https://www.sktoolhub.in/assets/image-cropper-og.jpg">
  
  <!-- Schema.org Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Free Online Image Cropper",
    "url": "https://www.sktoolhub.in/image-cropper.html",
    "applicationCategory": "DesignApplication",
    "operatingSystem": "Any",
    "description": "Free online tool to crop images to custom dimensions or preset aspect ratios. Supports JPG, PNG, WEBP formats.",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "author": {
      "@type": "Organization",
      "name": "SK Toolhub"
    },
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.8",
      "ratingCount": "1250"
    }
  }
  </script>
  
  <link rel="canonical" href="https://www.sktoolhub.in/image-cropper.html"/>
  
  <style>
    /* FIXED VISIBILITY - DARKER TEXT COLORS */
    body {
      font-family: 'Poppins', sans-serif;
      background: #f4f8ff;
      margin: 0;
      padding: 0;
      color: #333;
      line-height: 1.6;
    }
    
    .content-header {
      max-width: 900px;
      margin: 20px auto 30px;
      padding: 0 20px;
      text-align: center;
    }
    
    .main-title {
      color: #0066ff;
      font-size: 32px;
      margin-bottom: 15px;
      font-weight: 700;
    }
    
    .subtitle {
      color: #444;  /* DARKER FOR BETTER VISIBILITY */
      font-size: 18px;
      margin-bottom: 25px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    
    .feature-card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      text-align: center;
    }
    
    .feature-icon {
      font-size: 32px;
      margin-bottom: 10px;
      color: #0066ff;
    }
    
    .feature-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: #222;
    }
    
    .feature-desc {
      color: #444;  /* DARKER FOR BETTER VISIBILITY */
      font-size: 14px;
    }
    
    .how-to-steps {
      background: white;
      padding: 25px;
      border-radius: 12px;
      margin: 30px auto;
      max-width: 800px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    
    .how-to-steps h2 {
      text-align: center;
      color: #0066ff;
      margin-bottom: 20px;
    }
    
    .steps {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }
    
    .step {
      flex: 1;
      min-width: 150px;
      text-align: center;
      padding: 15px;
    }
    
    .step-number {
      background: #0066ff;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 10px;
      font-weight: bold;
    }
    
    .step div:not(.step-number) {
      color: #444;  /* DARKER STEP TEXT */
    }
    
    .container {
      background: #fff;
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      width: 90%;
      max-width: 900px;
      margin: 20px auto;
    }
    
    h2 {
      text-align: center;
      color: #0066ff;
      margin-top: 0;
      margin-bottom: 20px;
    }
    
    /* FORM LABELS - IMPROVED VISIBILITY */
    .container label {
      font-weight: 600;
      color: #222;  /* DARKER FOR BETTER VISIBILITY */
      display: block;
      margin-top: 15px;
      margin-bottom: 5px;
      font-size: 15px;
    }
    
    .form-section-title {
      font-weight: 700;
      color: #111;  /* VERY DARK FOR CLEAR VISIBILITY */
      margin-top: 20px;
      margin-bottom: 10px;
      font-size: 16px;
      border-bottom: 2px solid #0066ff;
      padding-bottom: 5px;
    }
    
    input, button, select {
      padding: 10px;
      margin: 8px 0;
      border: 1px solid #ccc;
      border-radius: 10px;
      font-size: 14px;
      box-sizing: border-box;
    }
    
    button {
      background: #0066ff;
      color: white;
      border: none;
      cursor: pointer;
      transition: 0.3s;
      font-weight: 600;
    }
    
    button:hover {
      background: #004ecc;
    }
    
    .preview {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      gap: 10px;
    }
    
    .preview img {
      border-radius: 10px;
      border: 1px solid #ddd;
      object-fit: contain;
      max-height: 300px;
    }
    
    .row {
      display: flex;
      gap: 10px;
    }
    
    .row > div {
      flex: 1;
    }
    
    .checkbox {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      margin-top: 6px;
      color: #444;  /* DARKER CHECKBOX TEXT */
    }
    
    .preset-buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin-top: 10px;
    }
    
    .preset-btn {
      padding: 10px;
      background: #f0f5ff;
      border: 1px solid #d9e4ff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
      text-align: center;
      color: #333;  /* DARK BUTTON TEXT */
    }
    
    .preset-btn:hover {
      background: #e1ebff;
      border-color: #0066ff;
      color: #0066ff;
    }
    
    .preset-btn.active {
      background: #0066ff;
      color: white;
      border-color: #0066ff;
    }
    
    .back-home {
      background: #ffffff;
      border-bottom: 1px solid #e5e7eb;
      text-align: center;
      padding: 12px 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }
    
    .back-home a {
      text-decoration: none;
      color: #0078D7;
      font-weight: 600;
      font-size: 16px;
      border: 2px solid #0078D7;
      padding: 6px 16px;
      border-radius: 25px;
      transition: 0.3s ease;
      display: inline-block;
    }
    
    .back-home a:hover {
      background: #0078D7;
      color: #ffffff;
      box-shadow: 0 2px 6px rgba(0,120,215,0.3);
    }
    
    .more-tools {
      margin-top: 35px;
      text-align: center;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
      padding: 0 20px;
    }
    
    .more-tools h3 {
      color: #0066ff;
      font-size: 20px;
      margin-bottom: 20px;
    }
    
    .more-tools ul {
      list-style: none;
      padding: 0;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
    }
    
    .more-tools li {
      margin: 5px;
    }
    
    .more-tools a {
      text-decoration: none;
      color: #0078D7;
      background: white;
      padding: 8px 16px;
      border-radius: 25px;
      border: 1px solid #0078D7;
      transition: 0.3s;
      display: inline-block;
    }
    
    .more-tools a:hover {
      background: #0078D7;
      color: white;
    }
    
    .faq-section {
      max-width: 800px;
      margin: 40px auto;
      padding: 0 20px;
    }
    
    .faq-section h2 {
      text-align: center;
      color: #0066ff;
      margin-bottom: 25px;
    }
    
    .faq-item {
      background: white;
      margin-bottom: 15px;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .faq-question {
      padding: 15px 20px;
      background: #f8faff;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #222;  /* DARKER FAQ TEXT */
    }
    
    .faq-answer {
      padding: 0 20px;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      color: #444;  /* DARKER FAQ ANSWER TEXT */
    }
    
    .faq-answer.active {
      padding: 15px 20px;
      max-height: 500px;
    }
    
    /* Cropper Specific Styles */
    .crop-container {
      position: relative;
      width: 100%;
      height: 400px;
      margin: 20px 0;
      border: 2px dashed #ddd;
      border-radius: 10px;
      overflow: hidden;
      background: #f9f9f9;
    }
    
    #cropperCanvas {
      position: absolute;
      top: 0;
      left: 0;
      cursor: crosshair;
    }
    
    .crop-selection {
      position: absolute;
      border: 2px solid #0066ff;
      background: rgba(0, 102, 255, 0.1);
      cursor: move;
    }
    
    .crop-handle {
      position: absolute;
      width: 10px;
      height: 10px;
      background: white;
      border: 2px solid #0066ff;
      border-radius: 2px;
    }
    
    .crop-controls {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 15px;
    }
    
    .crop-controls input {
      width: 100%;
    }
    
    .tool-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    
    .tool-buttons button {
      flex: 1;
    }
    
    .preview-area {
      display: none;
      margin-top: 20px;
    }
    
    .preview-area.active {
      display: block;
    }
    
    .preview-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-top: 15px;
    }
    
    .preview-box {
      text-align: center;
    }
    
    .preview-box img {
      width: 100%;
      max-height: 250px;
      border-radius: 8px;
    }
    
    .preview-box div {
      font-size: 12px;
      color: #444;  /* DARKER PREVIEW TEXT */
      margin-bottom: 5px;
    }
    
    @media (max-width: 768px) {
      .main-title {
        font-size: 24px;
      }
      
      .subtitle {
        font-size: 16px;
      }
      
      .features-grid {
        grid-template-columns: 1fr;
      }
      
      .steps {
        flex-direction: column;
      }
      
      .more-tools ul {
        flex-direction: column;
        align-items: center;
      }
      
      .more-tools li {
        width: 100%;
        max-width: 250px;
      }
      
      .container {
        width: 95%;
        padding: 20px;
      }
      
      .preset-buttons {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .crop-container {
        height: 300px;
      }
      
      .preview-grid {
        grid-template-columns: 1fr;
      }
      
      .crop-controls {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 480px) {
      .preset-buttons {
        grid-template-columns: 1fr;
      }
      
      .tool-buttons {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="back-home">
    <a href="index.html">‚Üê Back to Home</a>
  </div>

  <div class="content-header">
    <h1 class="main-title">Free Online Image Cropper Tool</h1>
    <p class="subtitle">Crop images to perfect size for profile pictures, social media, websites, and documents. Free, fast, and easy to use.</p>
    
    <div class="features-grid">
      <div class="feature-card">
        <div class="feature-icon">‚úÇÔ∏è</div>
        <div class="feature-title">Precise Cropping</div>
        <div class="feature-desc">Drag and drop to crop exactly what you want</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üõ°Ô∏è</div>
        <div class="feature-title">100% Secure</div>
        <div class="feature-desc">All processing happens in your browser, private & safe</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üìê</div>
        <div class="feature-title">Smart Ratios</div>
        <div class="feature-desc">Preset aspect ratios for all social media platforms</div>
      </div>
    </div>
    
    <div class="how-to-steps">
      <h2>How to Crop Images in 3 Simple Steps</h2>
      <div class="steps">
        <div class="step">
          <div class="step-number">1</div>
          <div><strong>Upload Image</strong></div>
          <div>Select your JPG, PNG or WebP file</div>
        </div>
        <div class="step">
          <div class="step-number">2</div>
          <div><strong>Select Area</strong></div>
          <div>Drag to select cropping area or choose preset</div>
        </div>
        <div class="step">
          <div class="step-number">3</div>
          <div><strong>Download</strong></div>
          <div>Get your perfectly cropped image instantly</div>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <h2>Image Cropper Tool</h2>
    
    <div class="row">
      <div style="flex: 1;">
        <div class="form-section-title">Upload Image</div>
        <input type="file" id="upload" accept="image/*" style="width: 100%;">
      </div>
      <div style="flex: 1;">
        <div class="form-section-title">Output Format</div>
        <select id="format" style="width: 100%;">
          <option value="image/jpeg">JPEG (.jpg)</option>
          <option value="image/png">PNG (.png)</option>
          <option value="image/webp">WebP (.webp)</option>
        </select>
      </div>
    </div>

    <div class="form-section-title">Quick Aspect Ratios</div>
    <div class="preset-buttons" id="presetButtons">
      <!-- Preset buttons will be added by JavaScript -->
    </div>

    <div class="form-section-title">Custom Dimensions</div>
    <div class="crop-controls">
      <div>
        <label>Width (px)</label>
        <input type="number" id="cropWidth" placeholder="Auto" min="1">
      </div>
      <div>
        <label>Height (px)</label>
        <input type="number" id="cropHeight" placeholder="Auto" min="1">
      </div>
    </div>

    <div class="form-section-title">Crop Area Selection</div>
    <div class="crop-container" id="cropContainer">
      <canvas id="cropperCanvas"></canvas>
      <div class="crop-selection" id="cropSelection" style="display: none;"></div>
    </div>

    <div class="tool-buttons">
      <button id="cropBtn" style="background: #00cc88;">Crop Image</button>
      <button id="resetCropBtn" style="background: #ff6b6b;">Reset Selection</button>
      <button id="rotateBtn">Rotate 90¬∞</button>
    </div>

    <div class="preview-area" id="previewArea">
      <div class="form-section-title" style="text-align: center; border-bottom: none;">Preview Results</div>
      <div class="preview-grid">
        <div class="preview-box">
          <div>Original Image</div>
          <img id="originalImg" alt="Original Image">
        </div>
        <div class="preview-box">
          <div>Cropped Image</div>
          <img id="croppedImg" alt="Cropped Image">
        </div>
      </div>
      <button id="downloadBtn" style="width: 100%; margin-top: 20px; padding: 12px;">Download Cropped Image</button>
    </div>
  </div>

  <div class="faq-section">
    <h2>Frequently Asked Questions</h2>
    
    <div class="faq-item">
      <div class="faq-question" onclick="toggleFAQ(this)">
        <span>What is image cropping?</span>
        <span>+</span>
      </div>
      <div class="faq-answer">
        <p>Image cropping is the process of removing unwanted outer areas from an image. It helps focus on the main subject, change aspect ratio, or fit images into specific dimensions for different platforms.</p>
      </div>
    </div>
    
    <div class="faq-item">
      <div class="faq-question" onclick="toggleFAQ(this)">
        <span>What are aspect ratios?</span>
        <span>+</span>
      </div>
      <div class="faq-answer">
        <p>Aspect ratio is the proportional relationship between an image's width and height. Common ratios include:
          <br>‚Ä¢ 1:1 (Square) - Instagram posts
          <br>‚Ä¢ 16:9 (Widescreen) - YouTube, presentations
          <br>‚Ä¢ 4:3 (Standard) - Traditional photos
          <br>‚Ä¢ 2:3 (Portrait) - Instagram stories
          <br>‚Ä¢ 9:16 (Vertical) - Mobile stories
        </p>
      </div>
    </div>
    
    <div class="faq-item">
      <div class="faq-question" onclick="toggleFAQ(this)">
        <span>What's the best size for profile pictures?</span>
        <span>+</span>
      </div>
      <div class="faq-answer">
        <p>
          ‚Ä¢ Facebook: 180x180 pixels (displays 170x170)<br>
          ‚Ä¢ Instagram: 110x110 pixels<br>
          ‚Ä¢ Twitter: 400x400 pixels<br>
          ‚Ä¢ LinkedIn: 400x400 pixels<br>
          ‚Ä¢ WhatsApp: 500x500 pixels<br>
          ‚Ä¢ YouTube: 800x800 pixels
        </p>
      </div>
    </div>
    
    <div class="faq-item">
      <div class="faq-question" onclick="toggleFAQ(this)">
        <span>Can I crop images without losing quality?</span>
        <span>+</span>
      </div>
      <div class="faq-answer">
        <p>Yes! Our tool uses lossless cropping for PNG format. For JPG/WebP, quality is maintained as much as possible. Cropping doesn't reduce quality unless you're making the image much smaller than original.</p>
      </div>
    </div>
    
    <div class="faq-item">
      <div class="faq-question" onclick="toggleFAQ(this)">
        <span>What image formats are supported?</span>
        <span>+</span>
      </div>
      <div class="faq-answer">
        <p>We support JPG, PNG, and WebP formats for both input and output. You can crop any of these formats and save in your preferred format.</p>
      </div>
    </div>
    
    <div class="faq-item">
      <div class="faq-question" onclick="toggleFAQ(this)">
        <span>Is my data safe?</span>
        <span>+</span>
      </div>
      <div class="faq-answer">
        <p>Absolutely! All image processing happens locally in your browser. Your images never leave your computer, and we don't store any data. Your privacy is 100% protected.</p>
      </div>
    </div>
  </div>

  <div class="more-tools">
    <h3>‚ú® More Useful Tools</h3>
    <ul>
      <li><a href="/image-converter.html">Image Converter</a></li>
      <li><a href="/image-compressor.html">Image Compressor</a></li>
      <li><a href="/image-resizer.html">Image Resizer</a></li>
      <li><a href="/image-rotator.html">Image Rotator / Flipper</a></li>
      <li><a href="/image-to-text.html">Image to Text</a></li>
      <li><a href="/background-remover.html">Background Remover</a></li>
      <li><a href="/pdf-compressor.html">PDF Compressor</a></li>
      <li><a href="/jpg-to-pdf.html">JPG to PDF</a></li>
      <li><a href="/pdf-to-jpg.html">PDF to JPG</a></li>
    </ul>
  </div>

  <script>
    // DOM Elements
    const upload = document.getElementById('upload');
    const formatSelect = document.getElementById('format');
    const cropWidth = document.getElementById('cropWidth');
    const cropHeight = document.getElementById('cropHeight');
    const cropContainer = document.getElementById('cropContainer');
    const cropperCanvas = document.getElementById('cropperCanvas');
    const cropSelection = document.getElementById('cropSelection');
    const cropBtn = document.getElementById('cropBtn');
    const resetCropBtn = document.getElementById('resetCropBtn');
    const rotateBtn = document.getElementById('rotateBtn');
    const previewArea = document.getElementById('previewArea');
    const originalImg = document.getElementById('originalImg');
    const croppedImg = document.getElementById('croppedImg');
    const downloadBtn = document.getElementById('downloadBtn');
    const presetButtons = document.getElementById('presetButtons');

    // Application State
    let originalImage = null;
    let ctx = null;
    let isDrawing = false;
    let startX = 0;
    let startY = 0;
    let selection = {
      x: 100,
      y: 100,
      width: 200,
      height: 200,
      ratio: null
    };
    let canvasScale = 1;
    let rotation = 0;

    // Preset Aspect Ratios
    const presets = [
      { ratio: '1:1', label: 'Square', width: 1, height: 1 },
      { ratio: '4:3', label: 'Standard', width: 4, height: 3 },
      { ratio: '16:9', label: 'Widescreen', width: 16, height: 9 },
      { ratio: '3:2', label: 'Photo', width: 3, height: 2 },
      { ratio: '2:3', label: 'Portrait', width: 2, height: 3 },
      { ratio: '9:16', label: 'Vertical', width: 9, height: 16 },
      { ratio: '5:4', label: 'Large Format', width: 5, height: 4 },
      { ratio: 'free', label: 'Free Form', width: 0, height: 0 }
    ];

    // Social Media Sizes
    const socialSizes = [
      { width: 1080, height: 1080, label: 'Instagram Post' },
      { width: 1080, height: 1350, label: 'Instagram Story' },
      { width: 1200, height: 630, label: 'Facebook Post' },
      { width: 180, height: 180, label: 'Profile Picture' },
      { width: 800, height: 800, label: 'YouTube Thumbnail' },
      { width: 1500, height: 500, label: 'Twitter Header' }
    ];

    // Initialize
    function init() {
      ctx = cropperCanvas.getContext('2d');
      initPresetButtons();
      setupEventListeners();
    }

    // Initialize preset buttons
    function initPresetButtons() {
      presetButtons.innerHTML = '';
      
      // Add aspect ratio presets
      presets.forEach(preset => {
        const button = document.createElement('button');
        button.className = 'preset-btn';
        button.textContent = preset.label;
        button.dataset.ratio = preset.ratio;
        button.dataset.width = preset.width;
        button.dataset.height = preset.height;
        button.onclick = () => selectPreset(button, preset);
        presetButtons.appendChild(button);
      });
      
      // Add social media size buttons
      const socialDiv = document.createElement('div');
      socialDiv.style.gridColumn = '1 / -1';
      socialDiv.style.marginTop = '10px';
      socialDiv.innerHTML = '<div class="form-section-title" style="border-bottom: none; margin-bottom: 5px;">Social Media Sizes</div>';
      
      const socialGrid = document.createElement('div');
      socialGrid.style.display = 'grid';
      socialGrid.style.gridTemplateColumns = 'repeat(3, 1fr)';
      socialGrid.style.gap = '8px';
      
      socialSizes.forEach(size => {
        const btn = document.createElement('button');
        btn.className = 'preset-btn';
        btn.textContent = size.label;
        btn.title = `${size.width}√ó${size.height}`;
        btn.onclick = () => selectSize(size);
        socialGrid.appendChild(btn);
      });
      
      socialDiv.appendChild(socialGrid);
      presetButtons.appendChild(socialDiv);
      
      // Activate first button
      const firstBtn = document.querySelector('.preset-btn');
      if (firstBtn) {
        firstBtn.classList.add('active');
        selection.ratio = presets[0].ratio;
      }
    }

    // Setup event listeners
    function setupEventListeners() {
      // Upload image
      upload.addEventListener('change', handleImageUpload);
      
      // Canvas events for cropping
      cropperCanvas.addEventListener('mousedown', startSelection);
      cropperCanvas.addEventListener('mousemove', drawSelection);
      cropperCanvas.addEventListener('mouseup', endSelection);
      
      // Touch events for mobile
      cropperCanvas.addEventListener('touchstart', handleTouchStart);
      cropperCanvas.addEventListener('touchmove', handleTouchMove);
      cropperCanvas.addEventListener('touchend', handleTouchEnd);
      
      // Control events
      cropWidth.addEventListener('input', updateSelectionFromInputs);
      cropHeight.addEventListener('input', updateSelectionFromInputs);
      
      // Button events
      cropBtn.addEventListener('click', cropImage);
      resetCropBtn.addEventListener('click', resetSelection);
      rotateBtn.addEventListener('click', rotateImage);
      downloadBtn.addEventListener('click', downloadImage);
      
      // Selection dragging
      cropSelection.addEventListener('mousedown', startDrag);
      document.addEventListener('mousemove', dragSelection);
      document.addEventListener('mouseup', endDrag);
    }

    // Handle image upload
    function handleImageUpload(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      if (file.size > 10 * 1024 * 1024) {
        alert('File size should be less than 10MB');
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(event) {
        originalImage = new Image();
        originalImage.onload = function() {
          // Reset rotation
          rotation = 0;
          
          // Update preview
          originalImg.src = event.target.result;
          
          // Setup canvas
          setupCanvas();
          
          // Draw image
          drawImageOnCanvas();
          
          // Set initial selection
          const size = Math.min(200, cropperCanvas.width * 0.5, cropperCanvas.height * 0.5);
          selection.x = (cropperCanvas.width - size) / 2;
          selection.y = (cropperCanvas.height - size) / 2;
          selection.width = size;
          selection.height = size;
          
          updateSelectionDisplay();
          updateInputsFromSelection();
        };
        originalImage.src = event.target.result;
      };
      reader.readAsDataURL(file);
    }

    // Setup canvas
    function setupCanvas() {
      const containerWidth = cropContainer.clientWidth - 4;
      const containerHeight = cropContainer.clientHeight - 4;
      
      canvasScale = Math.min(
        containerWidth / originalImage.width,
        containerHeight / originalImage.height
      );
      
      cropperCanvas.width = originalImage.width * canvasScale;
      cropperCanvas.height = originalImage.height * canvasScale;
      cropperCanvas.style.width = cropperCanvas.width + 'px';
      cropperCanvas.style.height = cropperCanvas.height + 'px';
    }

    // Draw image on canvas
    function drawImageOnCanvas() {
      ctx.clearRect(0, 0, cropperCanvas.width, cropperCanvas.height);
      
      // Save context
      ctx.save();
      
      // Apply rotation
      if (rotation !== 0) {
        ctx.translate(cropperCanvas.width / 2, cropperCanvas.height / 2);
        ctx.rotate(rotation * Math.PI / 180);
        ctx.translate(-cropperCanvas.width / 2, -cropperCanvas.height / 2);
      }
      
      // Draw image
      ctx.drawImage(originalImage, 0, 0, cropperCanvas.width, cropperCanvas.height);
      
      // Restore context
      ctx.restore();
    }

    // Start selection
    function startSelection(e) {
      isDrawing = true;
      const rect = cropperCanvas.getBoundingClientRect();
      startX = e.clientX - rect.left;
      startY = e.clientY - rect.top;
      
      selection.x = startX;
      selection.y = startY;
      selection.width = 0;
      selection.height = 0;
      
      updateSelectionDisplay();
    }

    // Draw selection
    function drawSelection(e) {
      if (!isDrawing) return;
      
      const rect = cropperCanvas.getBoundingClientRect();
      const currentX = e.clientX - rect.left;
      const currentY = e.clientY - rect.top;
      
      // Calculate width and height
      let width = currentX - startX;
      let height = currentY - startY;
      
      // Apply aspect ratio if set
      if (selection.ratio && selection.ratio !== 'free') {
        const [ratioW, ratioH] = selection.ratio.split(':').map(Number);
        const ratio = ratioW / ratioH;
        
        if (Math.abs(width) > Math.abs(height) * ratio) {
          width = Math.abs(height) * ratio * (width < 0 ? -1 : 1);
        } else {
          height = Math.abs(width) / ratio * (height < 0 ? -1 : 1);
        }
      }
      
      // Update selection
      if (width < 0) {
        selection.x = startX + width;
        selection.width = -width;
      } else {
        selection.x = startX;
        selection.width = width;
      }
      
      if (height < 0) {
        selection.y = startY + height;
        selection.height = -height;
      } else {
        selection.y = startY;
        selection.height = height;
      }
      
      // Ensure minimum size
      if (selection.width < 10) selection.width = 10;
      if (selection.height < 10) selection.height = 10;
      
      // Keep within canvas bounds
      if (selection.x < 0) {
        selection.width += selection.x;
        selection.x = 0;
      }
      if (selection.y < 0) {
        selection.height += selection.y;
        selection.y = 0;
      }
      if (selection.x + selection.width > cropperCanvas.width) {
        selection.width = cropperCanvas.width - selection.x;
      }
      if (selection.y + selection.height > cropperCanvas.height) {
        selection.height = cropperCanvas.height - selection.y;
      }
      
      updateSelectionDisplay();
      updateInputsFromSelection();
    }

    // End selection
    function endSelection() {
      isDrawing = false;
    }

    // Touch event handlers
    function handleTouchStart(e) {
      e.preventDefault();
      const touch = e.touches[0];
      const mouseEvent = new MouseEvent('mousedown', {
        clientX: touch.clientX,
        clientY: touch.clientY
      });
      cropperCanvas.dispatchEvent(mouseEvent);
    }

    function handleTouchMove(e) {
      e.preventDefault();
      const touch = e.touches[0];
      const mouseEvent = new MouseEvent('mousemove', {
        clientX: touch.clientX,
        clientY: touch.clientY
      });
      cropperCanvas.dispatchEvent(mouseEvent);
    }

    function handleTouchEnd(e) {
      e.preventDefault();
      const mouseEvent = new MouseEvent('mouseup');
      cropperCanvas.dispatchEvent(mouseEvent);
    }

    // Update selection display
    function updateSelectionDisplay() {
      if (selection.width > 0 && selection.height > 0) {
        cropSelection.style.display = 'block';
        cropSelection.style.left = selection.x + 'px';
        cropSelection.style.top = selection.y + 'px';
        cropSelection.style.width = selection.width + 'px';
        cropSelection.style.height = selection.height + 'px';
      } else {
        cropSelection.style.display = 'none';
      }
    }

    // Update inputs from selection
    function updateInputsFromSelection() {
      const actualWidth = Math.round(selection.width / canvasScale);
      const actualHeight = Math.round(selection.height / canvasScale);
      
      cropWidth.value = actualWidth;
      cropHeight.value = actualHeight;
    }

    // Update selection from inputs
    function updateSelectionFromInputs() {
      const width = parseInt(cropWidth.value) || 0;
      const height = parseInt(cropHeight.value) || 0;
      
      if (width > 0 && height > 0) {
        // Keep center position
        const newWidth = width * canvasScale;
        const newHeight = height * canvasScale;
        
        selection.x = selection.x + (selection.width - newWidth) / 2;
        selection.y = selection.y + (selection.height - newHeight) / 2;
        selection.width = newWidth;
        selection.height = newHeight;
        
        // Keep within bounds
        if (selection.x < 0) selection.x = 0;
        if (selection.y < 0) selection.y = 0;
        if (selection.x + selection.width > cropperCanvas.width) {
          selection.x = cropperCanvas.width - selection.width;
        }
        if (selection.y + selection.height > cropperCanvas.height) {
          selection.y = cropperCanvas.height - selection.height;
        }
        
        updateSelectionDisplay();
      }
    }

    // Select preset aspect ratio
    function selectPreset(button, preset) {
      // Update active button
      document.querySelectorAll('.preset-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      button.classList.add('active');
      
      // Update selection
      selection.ratio = preset.ratio;
      
      if (preset.width > 0 && preset.height > 0) {
        const ratio = preset.width / preset.height;
        
        // Adjust current selection to match ratio
        if (selection.width / selection.height > ratio) {
          selection.width = selection.height * ratio;
        } else {
          selection.height = selection.width / ratio;
        }
        
        updateSelectionDisplay();
        updateInputsFromSelection();
      }
    }

    // Select specific size
    function selectSize(size) {
      cropWidth.value = size.width;
      cropHeight.value = size.height;
      selection.ratio = null;
      updateSelectionFromInputs();
    }

    // Crop image
    function cropImage() {
      if (!originalImage) {
        alert('Please upload an image first!');
        return;
      }
      
      if (selection.width < 10 || selection.height < 10) {
        alert('Please select a cropping area first!');
        return;
      }
      
      // Calculate actual crop coordinates
      const actualX = Math.round(selection.x / canvasScale);
      const actualY = Math.round(selection.y / canvasScale);
      const actualWidth = Math.round(selection.width / canvasScale);
      const actualHeight = Math.round(selection.height / canvasScale);
      
      // Create canvas for cropped image
      const outputCanvas = document.createElement('canvas');
      outputCanvas.width = actualWidth;
      outputCanvas.height = actualHeight;
      const outputCtx = outputCanvas.getContext('2d');
      
      // Create temporary canvas for rotation
      const tempCanvas = document.createElement('canvas');
      tempCanvas.width = originalImage.width;
      tempCanvas.height = originalImage.height;
      const tempCtx = tempCanvas.getContext('2d');
      
      // Apply rotation to temp canvas
      if (rotation !== 0) {
        tempCtx.translate(tempCanvas.width / 2, tempCanvas.height / 2);
        tempCtx.rotate(rotation * Math.PI / 180);
        tempCtx.translate(-tempCanvas.width / 2, -tempCanvas.height / 2);
      }
      tempCtx.drawImage(originalImage, 0, 0);
      
      // Calculate rotated coordinates
      let cropX = actualX;
      let cropY = actualY;
      let cropWidth = actualWidth;
      let cropHeight = actualHeight;
      
      if (rotation !== 0) {
        if (rotation === 90 || rotation === 270) {
          [cropWidth, cropHeight] = [cropHeight, cropWidth];
        }
      }
      
      // Draw cropped area
      outputCtx.drawImage(
        tempCanvas,
        cropX, cropY, cropWidth, cropHeight,
        0, 0, outputCanvas.width, outputCanvas.height
      );
      
      // Get cropped image data
      const format = formatSelect.value;
      const quality = 0.92;
      const croppedDataUrl = outputCanvas.toDataURL(format, quality);
      
      // Update preview
      croppedImg.src = croppedDataUrl;
      previewArea.classList.add('active');
      
      // Scroll to preview
      previewArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      
      // Store for download
      outputCanvas.toBlob(function(blob) {
        croppedImg.dataset.blobUrl = URL.createObjectURL(blob);
      }, format, quality);
    }

    // Download image
    function downloadImage() {
      if (!croppedImg.src) return;
      
      const format = formatSelect.value;
      const ext = format === 'image/jpeg' ? 'jpg' : 
                  format === 'image/png' ? 'png' : 'webp';
      
      const link = document.createElement('a');
      link.download = `cropped-image.${ext}`;
      
      if (croppedImg.dataset.blobUrl) {
        link.href = croppedImg.dataset.blobUrl;
      } else {
        link.href = croppedImg.src;
      }
      
      link.click();
    }

    // Reset selection
    function resetSelection() {
      const size = Math.min(200, cropperCanvas.width * 0.5, cropperCanvas.height * 0.5);
      selection.x = (cropperCanvas.width - size) / 2;
      selection.y = (cropperCanvas.height - size) / 2;
      selection.width = size;
      selection.height = size;
      
      updateSelectionDisplay();
      updateInputsFromSelection();
    }

    // Rotate image
    function rotateImage() {
      rotation = (rotation + 90) % 360;
      drawImageOnCanvas();
      resetSelection();
    }

    // Selection dragging
    let isDragging = false;
    let dragStartX = 0;
    let dragStartY = 0;
    let selectionStartX = 0;
    let selectionStartY = 0;

    function startDrag(e) {
      isDragging = true;
      dragStartX = e.clientX;
      dragStartY = e.clientY;
      selectionStartX = selection.x;
      selectionStartY = selection.y;
      e.preventDefault();
    }

    function dragSelection(e) {
      if (!isDragging) return;
      
      const dx = e.clientX - dragStartX;
      const dy = e.clientY - dragStartY;
      
      selection.x = selectionStartX + dx;
      selection.y = selectionStartY + dy;
      
      // Keep within bounds
      if (selection.x < 0) selection.x = 0;
      if (selection.y < 0) selection.y = 0;
      if (selection.x + selection.width > cropperCanvas.width) {
        selection.x = cropperCanvas.width - selection.width;
      }
      if (selection.y + selection.height > cropperCanvas.height) {
        selection.y = cropperCanvas.height - selection.height;
      }
      
      updateSelectionDisplay();
      updateInputsFromSelection();
    }

    function endDrag() {
      isDragging = false;
    }

    // FAQ Functionality
    function toggleFAQ(element) {
      const answer = element.parentElement.querySelector('.faq-answer');
      const icon = element.querySelector('span:last-child');
      
      answer.classList.toggle('active');
      icon.textContent = answer.classList.contains('active') ? '‚àí' : '+';
    }

    // Initialize on load
    window.addEventListener('load', init);
  </script>
</body>
</html>
